<!doctype html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Enter Password</title>
    <link rel="stylesheet" href="../css/password-dialog.css" />
  </head>
  <body>
    <div class="container">
      <label for="password">Enter password to quit:</label>
      <input type="password" id="password" autofocus />
      <div class="button-group">
        <button class="cancel" onclick="cancelDialog()">Cancel</button>
        <button onclick="submitPassword()">Submit</button>
      </div>
    </div>
    <script>
      const { ipcRenderer } = (() => {
        try {
          return require('electron');
        } catch {
          return { ipcRenderer: null };
        }
      })();

      document.getElementById('password').addEventListener('keypress', (e) => {
        if (e.key === 'Enter') {
          submitPassword();
        }
      });

      document.addEventListener('keydown', (e) => {
        if (e.key === 'Escape') {
          cancelDialog();
        }
      });

      function submitPassword() {
        const password = document.getElementById('password').value;
        if (ipcRenderer && typeof ipcRenderer.send === 'function') {
          ipcRenderer.send('password-submit', password);
        }
      }

      function cancelDialog() {
        if (ipcRenderer && typeof ipcRenderer.send === 'function') {
          ipcRenderer.send('password-cancel');
        }
      }
    </script>
  </body>
</html>

